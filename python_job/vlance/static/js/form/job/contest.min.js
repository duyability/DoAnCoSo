$(document).ready(function(){$("#contest-form .popovers-input").popover();setForm();chosePackage();$("#contest-form").validate({rules:{"vlance_jobbundle_jobcontesttype[category]":{required:true},"vlance_jobbundle_jobcontesttype[title]":{minlength:2,required:true},"vlance_jobbundle_jobcontesttype[description]":{minlength:200,required:true,contact_leak:true}}});$("#edit-contest-form").validate({rules:{"vlance_jobbundle_jobcontesttype[category]":{required:true},"vlance_jobbundle_jobcontesttype[title]":{minlength:2,required:true},"vlance_jobbundle_jobcontesttype[description]":{minlength:200,required:true,contact_leak:true}}});$("#vlance_jobbundle_jobcontesttype_service").change(function(){$("#block-info-price").slideUp();var g=document.getElementById("vlance_jobbundle_jobcontesttype_service");var f=g.options[g.selectedIndex].value;if(typeof serPrice!="undefined"){$.ajax({url:serPrice,type:"GET",data:{ser_id:f}}).done(function(h){if(h.error==0){$("#choice-one").find("#vlance_jobbundle_jobcontesttype_budget").val(h.price1);$("#choice-two").find("#vlance_jobbundle_jobcontesttype_budget").val(h.price2);$("#choice-three").find("#vlance_jobbundle_jobcontesttype_budget").val(h.price3);document.getElementById("price_one").innerHTML=""+h.price1.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1.")+" <span>VNĐ</span>";document.getElementById("price_two").innerHTML=""+h.price2.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1.")+" <span>VNĐ</span>";document.getElementById("price_three").innerHTML=""+h.price3.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1.")+" <span>VNĐ</span>";$("#block-info-price").slideDown()}}).fail(function(h){}).always(function(){$("#block-info-price").slideDown()})}});function b(){$("#btn-submit-contest").prop("disabled",true);$("#contest-form").submit()}if(typeof logged!="undefined"&&logged=="false"){if(typeof reg_form_in_job!="undefined"&&typeof reg_form_in_job_params!="undefined"){var d=new c(reg_form_in_job,reg_form_in_job_params);d.formInitiate(function(){$("#reg-fullname,#reg-username,#reg-password,#reg-re-password").keypress(function(f){d.formSubmitOnEnter(f)})},function(){$("#btn-submit-register").click(function(f){if(d.getIsActive()){d.formSubmit()}});$("#btn-submit-contest").click(function(f){if(d.getIsActive()){d.formSubmitWithJob()}})})}if(typeof login_form_in_job!="undefined"&&typeof login_form_in_job_params!="undefined"){var a=new e(login_form_in_job,login_form_in_job_params);a.formInitiate(function(){$("#login_username, #login_password").keypress(function(f){a.formSubmitOnEnter(f)})},function(){$("#btn-submit-login").click(function(f){if(a.getIsActive()){a.formSubmit()}});$("#btn-submit-contest").click(function(f){if(a.getIsActive()){a.formSubmitWithJob()}})})}function c(f,g){this.url="";this.email="";this.fullname="";this.password=null;this.getIsActive=function(){return !($(f).parent().hasClass("deactive"))};this.setUrl=function(h){this.url=h};this.setEmail=function(h){this.email=h};this.setFullname=function(h){this.fullname=h};this.setPassword=function(h){this.password=h};this.formSubmitOnEnter=function(h){if(h.which==13){this.formSubmit()}};this.formInitiate=function(h,i){if(g.url!=null){this.setUrl(g.url)}this.formRules();this.decodeDataLoadCookie();h();i()};this.formSubmit=function(){that=this;if($(f).valid()===false){$(f).validate().focusInvalid();return false}that.encodeDataSaveCookie();that.setFullname(document.getElementById("reg-fullname").value);that.setEmail(document.getElementById("reg-username").value);that.setPassword(document.getElementById("reg-password").value);var h={email:that.email,fullname:that.fullname,password:that.password,type:"client"};$.ajax({url:that.url,type:"POST",data:h}).done(function(i){if(typeof i.error!="undefined"){if(i.error==0){$(".block-lr").hide();$('<div id="messages"><div class="body-messages"><div class="flash-success alert alert-success"><a class="close" data-dismiss="alert">×</a><div>Bạn đăng ký thành công</div></div></div></div>').insertBefore(".container");location.reload()}else{that.formRegFailed()}}})};this.formSubmitWithJob=function(){that=this;if($(f).valid()===false){$(f).validate().focusInvalid();return false}if($("#contest-form").valid()===false){$("#contest-form").validate().focusInvalid();return false}that.setFullname(document.getElementById("reg-fullname").value);that.setEmail(document.getElementById("reg-username").value);that.setPassword(document.getElementById("reg-password").value);var h={email:that.email,fullname:that.fullname,password:that.password,type:"client"};$.ajax({url:that.url,type:"POST",data:h}).done(function(i){if(typeof i.error!="undefined"){if(i.error==0){$(".block-lr").hide();b()}else{that.formRegFailed()}}})};this.formRules=function(){$(f).validate({rules:{fullname:{required:true},email:{required:true},password:{minlength:6,maxlength:32},"re-password":{minlength:6,maxlength:32,equalTo:"#reg-password"},focusInvalid:false}})};this.formRegFailed=function(){$(f+" label.error").remove();$("<label for='reg-username' style='display: block !important;' class='error row-fluid'><b>Email đã được đăng kí</b></label>").insertAfter(f+" .input-email");$("#reg-username").focus();return false};this.encodeDataSaveCookie=function(){var k=new Object();k.category=$("#vlance_jobbundle_jobcontesttype_category").val();k.service=$("#vlance_jobbundle_jobcontesttype_service").val();k.title=$("#vlance_jobbundle_jobcontesttype_title").val();k.description=$("#vlance_jobbundle_jobcontesttype_description").val();var i=JSON.stringify(k);var j=unescape(encodeURIComponent(i));var h=btoa(j);$.cookie("form_contest",h,{expires:0.5,path:"/"})};this.decodeDataLoadCookie=function(){that=this;var i=$.cookie("form_contest");if(typeof i!="undefined"){var j=atob(i);var k=decodeURIComponent(escape(j));var h=JSON.parse(k);if(h.category!=null){document.getElementById("vlance_jobbundle_jobcontesttype_category").value=h.category}if(h.service!=null){document.getElementById("vlance_jobbundle_jobcontesttype_service").value=h.service}if(h.title!=null){document.getElementById("vlance_jobbundle_jobcontesttype_title").value=h.title}if(h.description!=null){document.getElementById("vlance_jobbundle_jobcontesttype_description").value=h.description}$.removeCookie("form_contest",{path:"/"})}}}function e(g,f){this.url="";this.email="";this.password=null;this.getIsActive=function(){return !($(g).parent().hasClass("deactive"))};this.setUrl=function(h){this.url=h};this.setEmail=function(h){this.email=h};this.setPassword=function(h){this.password=h};this.formLoginFailed=function(){$(g+" label.error").remove();$("<label style='display: block !important;' class='error row-fluid'><b>Email hoặc mật khẩu không đúng</b></label>").insertAfter(g+" .input-email");$("#login_username").focus();return false};this.formSubmitOnEnter=function(h){if(h.which==13){this.formSubmit()}};this.formInitiate=function(h,i){if(f.url!=null){this.setUrl(f.url)}this.formRules();this.removeLaberError();h();i()};this.formRules=function(){$(g).validate({rules:{username:{required:true},password:{required:true},focusInvalid:false}})};this.formSubmit=function(){that=this;if($(g).valid()===false){$(g).validate().focusInvalid();return false}this.setEmail(document.getElementById("login_username").value);this.setPassword(document.getElementById("login_password").value);var h={email:that.email,password:that.password};$.ajax({url:that.url,type:"POST",data:h}).done(function(i){if(typeof i.error!="undefined"){if(i.error==0){$(".block-lr").hide();$('<div id="messages"><div class="body-messages"><div class="flash-success alert alert-success"><a class="close" data-dismiss="alert">×</a><div>Bạn đăng nhập thành công</div></div></div></div>').insertBefore(".container");location.reload()}else{that.formLoginFailed()}}})};this.formSubmitWithJob=function(){that=this;if($(g).valid()===false){$(g).validate().focusInvalid();return false}if($("#contest-form").valid()===false){$("#contest-form").validate().focusInvalid();return false}this.setEmail(document.getElementById("login_username").value);this.setPassword(document.getElementById("login_password").value);var h={email:that.email,password:that.password};$.ajax({url:that.url,type:"POST",data:h}).done(function(i){if(typeof i.error!="undefined"){if(i.error==0){$(".block-lr").hide();b()}else{that.formLoginFailed()}}})};this.removeLaberError=function(){$("#login_username").click(function(){$(g+" label.error.row-fluid").remove()});$("#login_password").click(function(){$(g+" label.error.row-fluid").remove()})}}}else{$("#btn-submit-contest").click(function(f){if($("#contest-form").valid()){b()}else{$("#contest-form").validate().focusInvalid();return false}})}$("#vlance_jobbundle_jobcontesttype_category").change(function(){var f=document.getElementById("vlance_jobbundle_jobcontesttype_category");var g=f.options[f.selectedIndex].value;if(typeof catser!="undefined"){$.ajax({url:catser,type:"GET",data:{cat_id:g}}).done(function(h){if(h.error==0){$("#vlance_jobbundle_jobcontesttype_service option:gt(0)").remove();for(var j=0;j<h.id.length;j++){$option=$("<option value="+h.id[j]+">"+h.title[j]+"</option>");$("#vlance_jobbundle_jobcontesttype_service").append($option)}}}).fail(function(h){}).always(function(){})}})});function chosePackage(){$("#choice-one").click(function(){$("#choice-one").parent().addClass("checked");$("#choice-two").parent().removeClass("checked");$("#choice-three").parent().removeClass("checked");$("#num_package").val(1)});$("#choice-two").click(function(){$("#choice-one").parent().removeClass("checked");$("#choice-two").parent().addClass("checked");$("#choice-three").parent().removeClass("checked");$("#num_package").val(2)});$("#choice-three").click(function(){$("#choice-one").parent().removeClass("checked");$("#choice-two").parent().removeClass("checked");$("#choice-three").parent().addClass("checked");$("#num_package").val(3)})}function addLoadingStatus(){$("#contest-form").find('input[type="submit"]').val($("#contest-form").find('input[type="submit"]').val()+".");setTimeout(addLoadingStatus,1700)}function setForm(){$("#new_user").click(function(){$(".block-form-reg.deactive").removeClass("deactive");$(".block-form-log").addClass("deactive");$("#old_user").parent().removeClass("checked");$("#new_user").parent().addClass("checked")});$("#old_user").click(function(){$(".block-form-log.deactive").removeClass("deactive");$(".block-form-reg").addClass("deactive");$("#new_user").parent().removeClass("checked");$("#old_user").parent().addClass("checked")})};