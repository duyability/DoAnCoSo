$(document).ready(function(){if(!$("body").hasClass("community_post_new")&&!$("body").hasClass("community_post")&&!$("body").hasClass("community_post_show")){selectForm();if(typeof login_form!="undefined"&&typeof login_form_params!="undefined"){var a=new d(login_form,login_form_params);a.formInitiate(function(){$("#login_username_header, #login_password_header").keypress(function(e){a.formSubmitOnEnter(e)})},function(){$("#btn-submit-login-header").click(function(e){a.formSubmit()})})}if(typeof reg_form!="undefined"&&typeof reg_form_params!="undefined"){var b=new c(reg_form,reg_form_params);b.formInitiate(function(){$("#reg-fullname-header,#reg-username-header,#reg-password-header,#reg-re-password-header").keypress(function(e){$(reg_form+" label.error").remove();b.formSubmitOnEnter(e)})},function(){$("#btn-submit-register-header").click(function(e){$(reg_form+" label.error").remove();b.formSubmit()})})}function d(f,e){this.url="";this.email="";this.password=null;this.setUrl=function(g){this.url=g};this.setEmail=function(g){this.email=g};this.setPassword=function(g){this.password=g};this.formLoginFailed=function(){$('<label class="error log"><b>Email hoặc mật khẩu không đúng</b></label>').insertBefore(".checkbox");$("#btn-submit-login-header").prop("disabled",false);$("#login_username_header").focus();return false};this.formInitiate=function(h,g){if(e.url!=null){this.setUrl(e.url)}this.removeLaberError();h();g()};this.formSubmitOnEnter=function(g){if(g.which==13){this.formSubmit()}};this.formSubmit=function(){that=this;if($(f).valid()===false){$(f).validate().focusInvalid();return false}$("#btn-submit-login-header").prop("disabled",true);this.setEmail(document.getElementById("login_username_header").value);this.setPassword(document.getElementById("login_password_header").value);var g={email:that.email,password:that.password};$.ajax({url:that.url,type:"POST",data:g}).done(function(h){if(typeof h.error!="undefined"){if(h.error==0){$(".login-box").slideUp(function(){location.reload()})}else{that.formLoginFailed()}}})};this.removeLaberError=function(){$(f).click(function(){$(f+" label.error.log").remove()})}}function c(e,f){this.url="";this.email="";this.fullname="";this.password=null;this.type="";this.setUrl=function(g){this.url=g};this.setEmail=function(g){this.email=g};this.setFullname=function(g){this.fullname=g};this.setPassword=function(g){this.password=g};this.setType=function(g){this.type=g};this.formRules=function(){$(e).validate({rules:{password:{minlength:6,maxlength:32},"re-password":{minlength:6,maxlength:32,equalTo:"#reg-password-header"}},messages:{password:{minlength:"Không được ngắn hơn 6 ký tự",maxlength:"Không được dài hơn 32 ký tự"},"re-password":{minlength:"Không được ngắn hơn 6 ký tự",maxlength:"Không được dài hơn 32 ký tự",equalTo:"Mật khẩu không trùng khớp"}}})};this.formInitiate=function(h,g){if(f.url!=null){this.setUrl(f.url)}this.formRules();h();g()};this.formSubmitOnEnter=function(g){if(g.which==13){this.formSubmit()}};this.formSubmit=function(){that=this;if($(e).valid()===false){$(e).validate().focusInvalid();return false}$("#btn-submit-register-header").prop("disabled",true);that.setFullname(document.getElementById("reg-fullname-header").value);that.setEmail(document.getElementById("reg-username-header").value);that.setPassword(document.getElementById("reg-password-header").value);that.setType(jQuery('input:radio[name="type"]:checked').val());var g={email:that.email,fullname:that.fullname,password:that.password,type:that.type};$.ajax({url:that.url,type:"POST",data:g}).done(function(h){if(typeof h.error!="undefined"){if(h.error==0){$(".signup-box").slideUp(function(){window.location.replace(h.verify_link)})}else{that.formRegFailed()}}})};this.formRegFailed=function(){$("<label for='reg-username-header' style='display: block !important;' class='error row-fluid'><b>Email đã được đăng kí</b></label>").insertAfter("#reg-username-header");$("#btn-submit-register-header").prop("disabled",false);$("#reg-username-header").focus();return false}}}});function selectForm(){$("#btn-close-log").click(function(){$(".login-box").slideUp()});$("#btn-close-signup").click(function(){$(".signup-box").slideUp()});$("#btn-login").click(function(){$(".signup-box").slideUp();$(".login-box").slideDown()});$("#btn-register").click(function(){$(".login-box").slideUp();$(".signup-box").slideDown()});$("#btn-login-mobile").click(function(){$(".signup-box").slideUp();$(".login-box").slideDown();$(".overlay-left").fadeToggle(200);$(".overlay-transparent").fadeToggle(100);$(".icon-hamberger a").toggleClass("btn-open").toggleClass("btn-close");open=false});$("#btn-register-mobile").click(function(){$(".login-box").slideUp();$(".signup-box").slideDown();$(".overlay-left").fadeToggle(200);$(".overlay-transparent").fadeToggle(100);$(".icon-hamberger a").toggleClass("btn-open").toggleClass("btn-close");open=false})};